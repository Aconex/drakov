<html>
    <head>
        <title>All The Things</title>
        <script>
            (function() {
                function ajax( method, url, success ) {
                    var xhr = new XMLHttpRequest();
                    xhr.open( method, url );
                    xhr.responseType = "json";
                    xhr.onreadystatechange = function() {
                        if( xhr.readyState === 4 ) {
                            success( xhr.response );
                        }
                    };
                    xhr.send();
                }

                function clickHandler( ev ) {
                    ajax( "PUT", "/api/things/" + ev.target.dataset.id + "/click" , function( result ) {
                        alert( "click registered: " + result.click );
                    });
                }

                function generateThing( spec ) {
                    var el = document.createElement("DIV");
                    el.textContent = spec.text;
                    el.dataset.id = spec.id;
                    el.addEventListener( "click", clickHandler );
                    document.body.appendChild( el );
                }

                document.addEventListener("DOMContentLoaded", function() {
                    ajax("GET", "/api/things", function( results ) {
                        results.forEach( generateThing );
                    });
                });
            })();
        </script>
        <style>
            DIV {
                float: left;
                height: 172px;
                width: 250px;
                text-align: center;
                font-family: Impact, sans-serif;
                font-weight: 900;
                font-size: 32px;
                color: white;
                text-shadow: 3px 3px 1px black;
                line-height: 306px;
                background-image: url(/allthethings.png);
                background-size: cover;
            }
        </style>
    </head>
    <body>
    </body>
</html>
